module.exports=[16292,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(15618),e=a.i(17755),f=a.i(99464),g=a.i(81560),h=a.i(70737),i=a.i(23292),j=a.i(49881),k=a.i(9020),l=a.i(62668),m=a.i(34450),n=a.i(23855),o=a.i(74358),p=a.i(33206),q=a.i(69100),r=a.i(35188),s=a.i(97074);function t({open:a,onOpenChange:d,classroom:e,onSuccess:f}){let g=!!e,[h,k]=(0,c.useState)(!1),[l,m]=(0,c.useState)([]),[n,t]=(0,c.useState)({name:"",groupId:"",location:"",capacity:"",description:"",notes:"",canBeBooked:!0,status:"available"});async function u(a){a.preventDefault(),k(!0);try{let a=g?`/api/classrooms/${e.id}`:"/api/classrooms",b=await fetch(a,{method:g?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n.name,groupId:n.groupId?parseInt(n.groupId,10):null,location:n.location||null,capacity:n.capacity?parseInt(n.capacity,10):null,description:n.description||null,notes:n.notes||null,canBeBooked:n.canBeBooked,status:n.status})}),c=await b.json();if(!b.ok)throw Error(c.error||"Something went wrong");f?.(c.classroom,g?"updated":"created"),d(!1)}catch(a){i.toast.error(a?.message||"Failed to save classroom")}finally{k(!1)}}return(0,c.useEffect)(()=>{fetch("/api/room-groups").then(a=>a.json()).then(a=>m(a.roomGroups||[])).catch(()=>{})},[]),(0,c.useEffect)(()=>{e?t({name:e.name||"",groupId:e.group_id?String(e.group_id):"",location:e.location||"",capacity:e.capacity?.toString()||"",description:e.description||"",notes:e.notes||"",canBeBooked:0!==e.can_be_booked,status:e.status||"available"}):t({name:"",groupId:"",location:"",capacity:"",description:"",notes:"",canBeBooked:!0,status:"available"})},[e,a]),(0,b.jsx)(o.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(o.DialogContent,{className:"sm:max-w-[500px]",children:[(0,b.jsxs)(o.DialogHeader,{children:[(0,b.jsx)(o.DialogTitle,{children:g?"Edit Classroom":"Add Classroom"}),(0,b.jsx)(o.DialogDescription,{children:g?"Update the classroom details below.":"Fill in the details to create a new classroom."})]}),(0,b.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"name",children:"Name *"}),(0,b.jsx)(p.Input,{id:"name",value:n.name,onChange:a=>t({...n,name:a.target.value}),placeholder:"e.g. Lab Komputer 1",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"roomGroup",children:"Room Group"}),(0,b.jsxs)(s.Select,{value:n.groupId,onValueChange:a=>t({...n,groupId:"none"===a?"":a}),children:[(0,b.jsx)(s.SelectTrigger,{children:(0,b.jsx)(s.SelectValue,{placeholder:"Select group..."})}),(0,b.jsxs)(s.SelectContent,{children:[(0,b.jsx)(s.SelectItem,{value:"none",children:"None"}),l.map(a=>(0,b.jsx)(s.SelectItem,{value:String(a.id),children:a.name},a.id))]})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"location",children:"Location"}),(0,b.jsx)(p.Input,{id:"location",value:n.location,onChange:a=>t({...n,location:a.target.value}),placeholder:"e.g. Block A, Level 2"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"capacity",children:"Capacity"}),(0,b.jsx)(p.Input,{id:"capacity",type:"number",min:"0",value:n.capacity,onChange:a=>t({...n,capacity:a.target.value}),placeholder:"e.g. 40"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"description",children:"Description"}),(0,b.jsx)(r.Textarea,{id:"description",value:n.description,onChange:a=>t({...n,description:a.target.value}),placeholder:"Optional description...",rows:2})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"notes",children:"Notes"}),(0,b.jsx)(r.Textarea,{id:"notes",value:n.notes,onChange:a=>t({...n,notes:a.target.value}),placeholder:"Internal notes...",rows:2})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"status",children:"Status"}),(0,b.jsxs)(s.Select,{value:n.status,onValueChange:a=>t({...n,status:a}),children:[(0,b.jsx)(s.SelectTrigger,{children:(0,b.jsx)(s.SelectValue,{})}),(0,b.jsxs)(s.SelectContent,{children:[(0,b.jsx)(s.SelectItem,{value:"available",children:"Available"}),(0,b.jsx)(s.SelectItem,{value:"maintenance",children:"Maintenance"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"bookable",children:"Bookable"}),(0,b.jsxs)(s.Select,{value:n.canBeBooked?"yes":"no",onValueChange:a=>t({...n,canBeBooked:"yes"===a}),children:[(0,b.jsx)(s.SelectTrigger,{children:(0,b.jsx)(s.SelectValue,{})}),(0,b.jsxs)(s.SelectContent,{children:[(0,b.jsx)(s.SelectItem,{value:"yes",children:"Yes"}),(0,b.jsx)(s.SelectItem,{value:"no",children:"No"})]})]})]})]}),(0,b.jsxs)(o.DialogFooter,{children:[(0,b.jsx)(j.Button,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"}),(0,b.jsx)(j.Button,{type:"submit",disabled:h,children:h?g?"Saving...":"Creating...":g?"Save Changes":"Create Classroom"})]})]})]})})}function u({open:a,onOpenChange:d,classroom:e,onSuccess:f}){let[g,h]=(0,c.useState)(!1);async function k(){if(e){h(!0);try{let a=await fetch(`/api/classrooms/${e.id}`,{method:"DELETE"}),b=await a.json();if(!a.ok)throw Error(b.error||"Something went wrong");f?.(e),d(!1)}catch(a){i.toast.error(a?.message||"Failed to delete classroom")}finally{h(!1)}}}return(0,b.jsx)(o.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(o.DialogContent,{className:"sm:max-w-[425px]",children:[(0,b.jsxs)(o.DialogHeader,{children:[(0,b.jsx)(o.DialogTitle,{children:"Delete Classroom"}),(0,b.jsxs)(o.DialogDescription,{children:["Are you sure you want to delete"," ",(0,b.jsx)("span",{className:"font-semibold",children:e?.name}),"? This action cannot be undone."]})]}),(0,b.jsxs)(o.DialogFooter,{children:[(0,b.jsx)(j.Button,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),(0,b.jsx)(j.Button,{variant:"destructive",onClick:k,disabled:g,children:g?"Deleting...":"Delete"})]})]})})}var v=a.i(50944),w=a.i(60702),x=a.i(13749),y=a.i(50522);let z=(0,a.i(70106).default)("circle-plus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var A=a.i(70121),B=a.i(50104),C=a.i(7554),D=a.i(25152),E=a.i(77994),F=a.i(3688),G=a.i(77192),H=a.i(30553),I="Checkbox",[J,K]=(0,B.createContextScope)(I),[L,M]=J(I);function N(a){let{__scopeCheckbox:d,checked:e,children:f,defaultChecked:g,disabled:h,form:i,name:j,onCheckedChange:k,required:l,value:m="on",internal_do_not_use_render:n}=a,[o,p]=(0,D.useControllableState)({prop:e,defaultProp:g??!1,onChange:k,caller:I}),[q,r]=c.useState(null),[s,t]=c.useState(null),u=c.useRef(!1),v=!q||!!i||!!q.closest("form"),w={checked:o,disabled:h,setChecked:p,control:q,setControl:r,name:j,form:i,value:m,hasConsumerStoppedPropagationRef:u,required:l,defaultChecked:!V(g)&&g,isFormControl:v,bubbleInput:s,setBubbleInput:t};return(0,b.jsx)(L,{scope:d,...w,children:"function"==typeof n?n(w):f})}var O="CheckboxTrigger",P=c.forwardRef(({__scopeCheckbox:a,onKeyDown:d,onClick:e,...f},g)=>{let{control:h,value:i,disabled:j,checked:k,required:l,setControl:m,setChecked:n,hasConsumerStoppedPropagationRef:o,isFormControl:p,bubbleInput:q}=M(O,a),r=(0,A.useComposedRefs)(g,m),s=c.useRef(k);return c.useEffect(()=>{let a=h?.form;if(a){let b=()=>n(s.current);return a.addEventListener("reset",b),()=>a.removeEventListener("reset",b)}},[h,n]),(0,b.jsx)(H.Primitive.button,{type:"button",role:"checkbox","aria-checked":V(k)?"mixed":k,"aria-required":l,"data-state":W(k),"data-disabled":j?"":void 0,disabled:j,value:i,...f,ref:r,onKeyDown:(0,C.composeEventHandlers)(d,a=>{"Enter"===a.key&&a.preventDefault()}),onClick:(0,C.composeEventHandlers)(e,a=>{n(a=>!!V(a)||!a),q&&p&&(o.current=a.isPropagationStopped(),o.current||a.stopPropagation())})})});P.displayName=O;var Q=c.forwardRef((a,c)=>{let{__scopeCheckbox:d,name:e,checked:f,defaultChecked:g,required:h,disabled:i,value:j,onCheckedChange:k,form:l,...m}=a;return(0,b.jsx)(N,{__scopeCheckbox:d,checked:f,defaultChecked:g,disabled:i,required:h,onCheckedChange:k,name:e,form:l,value:j,internal_do_not_use_render:({isFormControl:a})=>(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(P,{...m,ref:c,__scopeCheckbox:d}),a&&(0,b.jsx)(U,{__scopeCheckbox:d})]})})});Q.displayName=I;var R="CheckboxIndicator",S=c.forwardRef((a,c)=>{let{__scopeCheckbox:d,forceMount:e,...f}=a,g=M(R,d);return(0,b.jsx)(G.Presence,{present:e||V(g.checked)||!0===g.checked,children:(0,b.jsx)(H.Primitive.span,{"data-state":W(g.checked),"data-disabled":g.disabled?"":void 0,...f,ref:c,style:{pointerEvents:"none",...a.style}})})});S.displayName=R;var T="CheckboxBubbleInput",U=c.forwardRef(({__scopeCheckbox:a,...d},e)=>{let{control:f,hasConsumerStoppedPropagationRef:g,checked:h,defaultChecked:i,required:j,disabled:k,name:l,value:m,form:n,bubbleInput:o,setBubbleInput:p}=M(T,a),q=(0,A.useComposedRefs)(e,p),r=(0,E.usePrevious)(h),s=(0,F.useSize)(f);c.useEffect(()=>{if(!o)return;let a=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,b=!g.current;if(r!==h&&a){let c=new Event("click",{bubbles:b});o.indeterminate=V(h),a.call(o,!V(h)&&h),o.dispatchEvent(c)}},[o,r,h,g]);let t=c.useRef(!V(h)&&h);return(0,b.jsx)(H.Primitive.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??t.current,required:j,disabled:k,name:l,value:m,form:n,...d,tabIndex:-1,ref:q,style:{...d.style,...s,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function V(a){return"indeterminate"===a}function W(a){return V(a)?"indeterminate":a?"checked":"unchecked"}U.displayName=T;var X=a.i(6406),Y=a.i(97630);let Z=c.forwardRef(({className:a,...c},d)=>(0,b.jsx)(Q,{ref:d,"data-slot":"checkbox",className:(0,Y.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",a),...c,children:(0,b.jsx)(S,{"data-slot":"checkbox-indicator",className:(0,Y.cn)("flex items-center justify-center text-current"),children:(0,b.jsx)(X.CheckIcon,{className:"h-4 w-4"})})}));function $({open:a,onOpenChange:d,classroom:e,onSuccess:f,initialDate:g,initialTimeSlotId:h,lockDate:k=!1,lockTimeSlot:l=!1,multiSelect:m=!1,classrooms:n=[]}){let[t,u]=(0,c.useState)(!1),[v,w]=(0,c.useState)([]),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(""),[B,C]=(0,c.useState)({bookingDate:"",timeSlotId:"",purpose:"",teacherName:""});async function D(a){a.preventDefault();let b=m&&z?z:e?.id;if(!b)return void i.toast.error("Please select a classroom");let c=m?x:[B.timeSlotId];if(0===c.length)return void i.toast.error("Please select at least one time slot");u(!0);try{if(m){let a=await fetch("/api/bookings/bulk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({classroomId:parseInt(b,10),bookingDate:B.bookingDate,timeSlotIds:c,purpose:B.purpose,teacherName:B.teacherName})}),e=await a.json();if(!a.ok)throw Error(e.error||"Failed to create bookings");f?.(e.bookings),d(!1),i.toast.success(`${e.bookings.length} booking(s) requested successfully`)}else{let a=await fetch("/api/bookings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({classroomId:parseInt(b,10),bookingDate:B.bookingDate,timeSlotId:B.timeSlotId,purpose:B.purpose,teacherName:B.teacherName})}),c=await a.json();if(!a.ok)throw Error(c.error||"Failed to create booking");f?.(c.booking),d(!1),i.toast.success("Booking requested successfully")}}catch(a){i.toast.error(a?.message||"Failed to create booking")}finally{u(!1)}}return(0,c.useEffect)(()=>{a&&(C({bookingDate:g||"",timeSlotId:h||"",purpose:"",teacherName:""}),m&&(y(h?[h]:[]),A(e?.id?String(e.id):"")),fetch("/api/time-slots").then(a=>a.json()).then(a=>w(a.timeSlots||[])).catch(()=>{i.toast.error("Failed to load time slots")}))},[a,g,h,m,e]),(0,b.jsx)(o.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(o.DialogContent,{className:"sm:max-w-[480px]",children:[(0,b.jsxs)(o.DialogHeader,{children:[(0,b.jsx)(o.DialogTitle,{children:"Book Classroom"}),(0,b.jsx)(o.DialogDescription,{children:m?"Select classrooms and time slots to book multiple at once.":e?.name?`Request a booking for ${e.name}.`:"Request a booking."})]}),(0,b.jsxs)("form",{onSubmit:D,className:"space-y-4",children:[m&&n.length>0&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"classroom",children:"Classroom *"}),(0,b.jsxs)(s.Select,{value:z,onValueChange:A,children:[(0,b.jsx)(s.SelectTrigger,{id:"classroom",className:"w-full",children:(0,b.jsx)(s.SelectValue,{placeholder:"Select classroom"})}),(0,b.jsx)(s.SelectContent,{children:n.map(a=>(0,b.jsx)(s.SelectItem,{value:String(a.id),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"bookingDate",children:"Date *"}),(0,b.jsx)(p.Input,{id:"bookingDate",type:"date",value:B.bookingDate,onChange:a=>C(b=>({...b,bookingDate:a.target.value})),disabled:k,required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(q.Label,{htmlFor:"timeSlot",children:["Time Slot",m?"s":""," *"]}),m?(0,b.jsx)("div",{className:"max-h-60 space-y-2 overflow-y-auto rounded-md border p-3",children:0===v.length?(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No slots available"}):v.map(a=>(0,b.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,b.jsx)(Z,{id:`slot-${a.id}`,checked:x.includes(String(a.id)),onCheckedChange:b=>{b?y(b=>[...b,String(a.id)]):y(b=>b.filter(b=>b!==String(a.id)))},disabled:l}),(0,b.jsxs)("label",{htmlFor:`slot-${a.id}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:[a.label," (",a.start_time," - ",a.end_time,")"]})]},a.id))}):(0,b.jsxs)(s.Select,{value:B.timeSlotId,onValueChange:a=>C(b=>({...b,timeSlotId:a})),disabled:l,children:[(0,b.jsx)(s.SelectTrigger,{id:"timeSlot",className:"w-full",children:(0,b.jsx)(s.SelectValue,{placeholder:"Select time slot"})}),(0,b.jsxs)(s.SelectContent,{children:[0===v.length&&(0,b.jsx)(s.SelectItem,{value:"no-slots",disabled:!0,children:"No slots available"}),v.map(a=>(0,b.jsxs)(s.SelectItem,{value:String(a.id),children:[a.label," (",a.start_time," - ",a.end_time,")"]},a.id))]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"teacherName",children:"Teacher Name"}),(0,b.jsx)(p.Input,{id:"teacherName",value:B.teacherName,onChange:a=>C(b=>({...b,teacherName:a.target.value})),placeholder:"Enter teacher name"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(q.Label,{htmlFor:"purpose",children:"Purpose"}),(0,b.jsx)(r.Textarea,{id:"purpose",value:B.purpose,onChange:a=>C(b=>({...b,purpose:a.target.value})),placeholder:"Describe the purpose of this booking",rows:3})]}),(0,b.jsxs)(o.DialogFooter,{children:[(0,b.jsx)(j.Button,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"}),(0,b.jsx)(j.Button,{type:"submit",disabled:t,children:t?"Submitting...":"Submit Request"})]})]})]})})}function _(){return new Date().toISOString().slice(0,10)}Z.displayName="Checkbox";function aa(){let a=(0,v.useSearchParams)().get("date"),[d,e]=(0,c.useState)([]),[f,g]=(0,c.useState)([]),[h,l]=(0,c.useState)([]),[m,n]=(0,c.useState)([]),[o,q]=(0,c.useState)([]),[r,t]=(0,c.useState)(""),[u,A]=(0,c.useState)("all"),[B,C]=(0,c.useState)(a||_()),[D,E]=(0,c.useState)(!1),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(""),[J,K]=(0,c.useState)(!1);(0,c.useEffect)(()=>{Promise.all([fetch("/api/sessions").then(a=>a.json()),fetch("/api/room-groups").then(a=>a.json()),fetch("/api/time-slots").then(a=>a.json())]).then(([a,b,c])=>{let d=a.sessions||[];if(e(d),g(b.roomGroups||[]),l(c.timeSlots||[]),d.length>0){var f,h;let a=_(),b=d.find(b=>{var c,d;return c=b.start_date,d=b.end_date,a>=c&&a<=d})||d[0];t(String(b.id)),f=b.start_date,h=b.end_date,a>=f&&a<=h||C(b.start_date)}}).catch(()=>i.toast.error("Failed to load booking filters"))},[]),(0,c.useEffect)(()=>{if(!B)return;let a="all"===u?"":u,b=a?`/api/classrooms?groupId=${a}`:"/api/classrooms",c=a?`/api/bookings?date=${B}&groupId=${a}`:`/api/bookings?date=${B}`;Promise.all([fetch(b).then(a=>a.json()),fetch(c).then(a=>a.json())]).then(([a,b])=>{n(a.classrooms||[]),q(b.bookings||[])}).catch(()=>i.toast.error("Failed to load booking grid"))},[B,u]),(0,c.useEffect)(()=>{if(!r||0===d.length)return;let a=d.find(a=>String(a.id)===String(r));if(a){var b,c;b=a.start_date,c=a.end_date,B>=b&&B<=c||C(a.start_date)}},[r,d,B]);let L=(0,c.useMemo)(()=>{let a=new Map;return o.forEach(b=>{a.set(`${b.classroom_id}-${b.time_slot_id}`,b)}),a},[o]);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-muted",children:(0,b.jsx)(w.CalendarDays,{className:"h-4 w-4 text-foreground"})}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"Booking Grid"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Choose a room and time slot to request a booking."})]})]}),(0,b.jsxs)(j.Button,{onClick:function(){0===m.length?i.toast.error("No classrooms available"):(G(m[0]),I(""),K(!0),E(!0))},variant:"outline",size:"sm",children:[(0,b.jsx)(z,{className:"mr-2 h-4 w-4"}),"Book Multiple Slots"]})]})}),(0,b.jsx)("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"rounded-lg border bg-background p-4",children:[(0,b.jsx)("label",{className:"text-xs font-medium text-muted-foreground",children:"Room Group"}),(0,b.jsxs)(s.Select,{value:u,onValueChange:A,children:[(0,b.jsx)(s.SelectTrigger,{className:"mt-3 w-full",children:(0,b.jsx)(s.SelectValue,{placeholder:"All Groups"})}),(0,b.jsxs)(s.SelectContent,{children:[(0,b.jsx)(s.SelectItem,{value:"all",children:"All Groups"}),f.map(a=>(0,b.jsx)(s.SelectItem,{value:String(a.id),children:a.name},a.id))]})]})]}),(0,b.jsxs)("div",{className:"rounded-lg border bg-background p-4",children:[(0,b.jsx)("label",{className:"text-xs font-medium text-muted-foreground",children:"Session"}),(0,b.jsxs)(s.Select,{value:r,onValueChange:t,children:[(0,b.jsx)(s.SelectTrigger,{className:"mt-3 w-full",children:(0,b.jsx)(s.SelectValue,{placeholder:"Select session"})}),(0,b.jsx)(s.SelectContent,{children:d.map(a=>(0,b.jsx)(s.SelectItem,{value:String(a.id),children:a.name},a.id))})]})]}),(0,b.jsxs)("div",{className:"rounded-lg border bg-background p-4",children:[(0,b.jsx)("label",{className:"text-xs font-medium text-muted-foreground",children:"Date"}),(0,b.jsx)(p.Input,{type:"date",value:B,onChange:a=>C(a.target.value),className:"mt-3 w-full"})]})]})}),(0,b.jsx)("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,b.jsxs)(j.Button,{variant:"outline",size:"sm",onClick:function(){let a=new Date(B);a.setDate(a.getDate()-1),C(a.toISOString().slice(0,10))},children:[(0,b.jsx)(x.ChevronLeft,{className:"mr-1 h-4 w-4"}),"Previous Day"]}),(0,b.jsx)(k.Badge,{variant:"secondary",className:"font-mono text-xs",children:B}),(0,b.jsxs)(j.Button,{variant:"outline",size:"sm",onClick:function(){let a=new Date(B);a.setDate(a.getDate()+1),C(a.toISOString().slice(0,10))},children:["Next Day",(0,b.jsx)(y.ChevronRight,{className:"ml-1 h-4 w-4"})]})]})}),(0,b.jsx)("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:(0,b.jsx)("div",{className:"overflow-x-auto rounded-xl border bg-background",children:(0,b.jsx)("div",{className:"min-w-[900px]",children:(0,b.jsxs)("table",{className:"w-full border-separate border-spacing-0",children:[(0,b.jsx)("thead",{children:(0,b.jsxs)("tr",{children:[(0,b.jsx)("th",{className:"border-b bg-muted/40 px-5 py-4 text-left text-sm font-semibold text-foreground",children:"Room"}),h.map((a,c)=>(0,b.jsxs)("th",{className:`border-b bg-muted/40 px-4 py-4 text-center text-sm font-semibold text-foreground ${c===h.length-1?"":"border-l"}`,children:[(0,b.jsx)("div",{children:a.label}),(0,b.jsxs)("div",{className:"mt-1 text-xs text-muted-foreground",children:[a.start_time," - ",a.end_time]})]},a.id))]})}),(0,b.jsx)("tbody",{children:m.map((a,c)=>(0,b.jsxs)("tr",{className:c%2?"bg-muted/20":"bg-background",children:[(0,b.jsx)("td",{className:"border-b px-5 py-4 text-sm font-semibold text-foreground",children:a.name}),h.map((c,d)=>{let e=L.get(`${a.id}-${c.id}`),f=!!e;return(0,b.jsx)("td",{className:`border-b px-4 py-4 text-center text-xs ${d===h.length-1?"":"border-l"}`,children:f?(0,b.jsxs)("div",{className:"rounded-md border border-rose-200 bg-rose-50 px-3 py-3 text-rose-700",children:[(0,b.jsx)("div",{className:"text-[0.7rem] font-semibold",children:"Booked"}),(0,b.jsx)("div",{className:"text-[0.65rem] text-rose-600",children:e.user_name||"Reserved"})]}):(0,b.jsx)("button",{type:"button",className:"w-full rounded-md border border-emerald-200 bg-emerald-50 px-3 py-3 text-[0.7rem] font-semibold text-emerald-700 transition hover:bg-emerald-100",onClick:()=>{G(a),I(String(c.id)),K(!1),E(!0)},children:"Available"})},c.id)})]},a.id))})]})})})}),(0,b.jsx)($,{open:D,onOpenChange:E,classroom:F,classrooms:m,initialDate:B,initialTimeSlotId:H,lockDate:!J,lockTimeSlot:!J,multiSelect:J,onSuccess:function(){i.toast.success("Booking requested successfully"),E(!1);let a="all"===u?"":u;fetch(a?`/api/bookings?date=${B}&groupId=${a}`:`/api/bookings?date=${B}`).then(a=>a.json()).then(a=>{q(a.bookings||[])}).catch(()=>i.toast.error("Failed to refresh bookings"))}})]})}function ab(){let[a,o]=(0,c.useState)([]),[p,q]=(0,c.useState)(!0),[r,s]=(0,c.useState)(null),[v,w]=(0,c.useState)(!1),[x,y]=(0,c.useState)(!1),[z,A]=(0,c.useState)(!1),[B,C]=(0,c.useState)(null),D=(0,c.useCallback)(async()=>{try{let a=await fetch("/api/classrooms"),b=await a.json();if(!a.ok)throw Error(b.error||"Failed to load classrooms");o(b.classrooms||[])}catch(a){i.toast.error(a?.message||"Failed to load classrooms")}finally{q(!1)}},[]);(0,c.useEffect)(()=>{D(),fetch("/api/auth/me").then(a=>a.json()).then(a=>s(a.user)).catch(()=>{})},[D]);let E=r?.role==="admin";return p?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(l.Skeleton,{className:"h-7 w-40"}),(0,b.jsx)(l.Skeleton,{className:"h-4 w-64"})]}),(0,b.jsx)(l.Skeleton,{className:"h-9 w-32"})]}),(0,b.jsx)("div",{className:"rounded-lg border",children:(0,b.jsx)("div",{className:"space-y-2 p-4",children:Array.from({length:6}).map((a,c)=>(0,b.jsx)(l.Skeleton,{className:"h-8 w-full"},c))})})]}):E?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("h2",{className:"text-2xl font-semibold font-[var(--font-display)]",children:"Classrooms"}),(0,b.jsx)(k.Badge,{variant:"secondary",children:a.length})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage classroom details and availability"})]}),E&&(0,b.jsxs)(j.Button,{onClick:()=>w(!0),children:[(0,b.jsx)(d.Plus,{className:"mr-2 h-4 w-4"}),"Add Classroom"]})]}),0===a.length?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3 rounded-lg border py-12 text-center",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-muted",children:(0,b.jsx)(h.School,{className:"h-5 w-5 text-muted-foreground"})}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"font-medium",children:"No classrooms yet"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Create your first classroom to get started."})]}),E&&(0,b.jsxs)(j.Button,{variant:"outline",className:"mt-4",onClick:()=>w(!0),children:[(0,b.jsx)(d.Plus,{className:"mr-2 h-4 w-4"}),"Add your first classroom"]})]}):(0,b.jsx)("div",{className:"rounded-lg border",children:(0,b.jsxs)(m.Table,{children:[(0,b.jsxs)(m.TableCaption,{children:["Showing ",a.length," classroom",1===a.length?"":"s"]}),(0,b.jsx)(m.TableHeader,{children:(0,b.jsxs)(m.TableRow,{children:[(0,b.jsx)(m.TableHead,{children:"Name"}),(0,b.jsx)(m.TableHead,{children:"Group"}),(0,b.jsx)(m.TableHead,{children:"Location"}),(0,b.jsx)(m.TableHead,{children:"Capacity"}),(0,b.jsx)(m.TableHead,{children:"Status"}),(0,b.jsx)(m.TableHead,{children:"Bookable"}),E&&(0,b.jsx)(m.TableHead,{className:"w-[70px]",children:"Actions"})]})}),(0,b.jsx)(m.TableBody,{children:a.map(a=>(0,b.jsxs)(m.TableRow,{children:[(0,b.jsx)(m.TableCell,{className:"font-medium",children:a.name}),(0,b.jsx)(m.TableCell,{className:a.group_name?"":"text-muted-foreground",children:a.group_name||"—"}),(0,b.jsx)(m.TableCell,{className:a.location?"":"text-muted-foreground",children:a.location||"—"}),(0,b.jsx)(m.TableCell,{className:null===a.capacity?"text-muted-foreground":"",children:a.capacity??"—"}),(0,b.jsx)(m.TableCell,{children:(0,b.jsx)(k.Badge,{variant:"available"===a.status?"default":"secondary",className:"capitalize",children:a.status})}),(0,b.jsx)(m.TableCell,{children:(0,b.jsx)(k.Badge,{variant:a.can_be_booked?"default":"secondary",children:a.can_be_booked?"Yes":"No"})}),E&&(0,b.jsx)(m.TableCell,{children:(0,b.jsxs)(n.DropdownMenu,{children:[(0,b.jsx)(n.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(j.Button,{variant:"ghost",className:"h-8 w-8 p-0",children:(0,b.jsx)(e.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(n.DropdownMenuContent,{align:"end",children:[(0,b.jsxs)(n.DropdownMenuItem,{onClick:()=>{C(a),y(!0)},children:[(0,b.jsx)(f.Pencil,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,b.jsxs)(n.DropdownMenuItem,{className:"text-destructive",onClick:()=>{C(a),A(!0)},children:[(0,b.jsx)(g.Trash2,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},a.id))})]})}),(0,b.jsx)(t,{open:v,onOpenChange:w,classroom:null,onSuccess:function(a){o(b=>[...b,a].sort((a,b)=>a.name.localeCompare(b.name))),i.toast.success(`Classroom "${a.name}" created successfully`)}}),(0,b.jsx)(t,{open:x,onOpenChange:y,classroom:B,onSuccess:function(a){o(b=>b.map(b=>b.id===a.id?a:b).sort((a,b)=>a.name.localeCompare(b.name))),i.toast.success(`Classroom "${a.name}" updated successfully`)}}),(0,b.jsx)(u,{open:z,onOpenChange:A,classroom:B,onSuccess:function(a){o(b=>b.filter(b=>b.id!==a.id)),i.toast.success(`Classroom "${a.name}" deleted successfully`)}})]}):(0,b.jsx)(aa,{})}a.s(["default",()=>ab],16292)}];

//# sourceMappingURL=src_app_dashboard_classrooms_page_jsx_97b2e315._.js.map