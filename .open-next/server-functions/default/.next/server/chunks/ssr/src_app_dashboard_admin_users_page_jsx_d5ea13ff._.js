module.exports=[40950,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(15618),e=a.i(17755),f=a.i(99464),g=a.i(81560),h=a.i(70106);let i=(0,h.default)("circle-user",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]),j=(0,h.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);var k=a.i(13749),l=a.i(50522),m=a.i(23292),n=a.i(49881),o=a.i(9020),p=a.i(33206),q=a.i(62668),r=a.i(34450),s=a.i(97074),t=a.i(23855),u=a.i(74358),v=a.i(69100);function w({open:a,onOpenChange:d,user:e,departments:f,onSuccess:g}){let h=!!e,[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)({username:"",email:"",password:"",fullName:"",role:"user",departmentId:""});async function o(a){a.preventDefault(),j(!0);try{let a=h?`/api/users/${e.id}`:"/api/users",b={username:k.username||null,email:k.email,fullName:k.fullName,role:k.role,departmentId:k.departmentId?parseInt(k.departmentId,10):null};if(k.password)b.password=k.password;else if(!h){m.toast.error("Password is required for new users"),j(!1);return}let c=await fetch(a,{method:h?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),f=await c.json();if(!c.ok)throw Error(f.error||"Something went wrong");g?.(f.user,h?"updated":"created"),d(!1)}catch(a){m.toast.error(a?.message||"Failed to save user")}finally{j(!1)}}return(0,c.useEffect)(()=>{e?l({username:e.username||"",email:e.email||"",password:"",fullName:e.full_name||"",role:e.role||"user",departmentId:e.department_id?String(e.department_id):""}):l({username:"",email:"",password:"",fullName:"",role:"user",departmentId:""})},[e,a]),(0,b.jsx)(u.Dialog,{open:a,onOpenChange:d,children:(0,b.jsxs)(u.DialogContent,{className:"sm:max-w-[480px]",children:[(0,b.jsxs)(u.DialogHeader,{children:[(0,b.jsx)(u.DialogTitle,{children:h?"Edit User":"Add User"}),(0,b.jsx)(u.DialogDescription,{children:h?"Update user details. Leave password blank to keep existing.":"Fill in the details to create a new user account."})]}),(0,b.jsxs)("form",{onSubmit:o,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(v.Label,{htmlFor:"username",children:"Username"}),(0,b.jsx)(p.Input,{id:"username",value:k.username,onChange:a=>l({...k,username:a.target.value}),placeholder:"e.g. johndoe"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(v.Label,{htmlFor:"fullName",children:"Full Name"}),(0,b.jsx)(p.Input,{id:"fullName",value:k.fullName,onChange:a=>l({...k,fullName:a.target.value}),placeholder:"e.g. John Doe"})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(v.Label,{htmlFor:"userEmail",children:"Email *"}),(0,b.jsx)(p.Input,{id:"userEmail",type:"email",value:k.email,onChange:a=>l({...k,email:a.target.value}),placeholder:"user@example.com",required:!0})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(v.Label,{htmlFor:"userPassword",children:["Password ",h?"(leave blank to keep)":"*"]}),(0,b.jsx)(p.Input,{id:"userPassword",type:"password",value:k.password,onChange:a=>l({...k,password:a.target.value}),placeholder:h?"Leave blank to keep existing":"Min 6 characters",...!h&&{required:!0,minLength:6}})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(v.Label,{htmlFor:"userRole",children:"Role"}),(0,b.jsxs)(s.Select,{value:k.role,onValueChange:a=>l({...k,role:a}),children:[(0,b.jsx)(s.SelectTrigger,{children:(0,b.jsx)(s.SelectValue,{})}),(0,b.jsxs)(s.SelectContent,{children:[(0,b.jsx)(s.SelectItem,{value:"user",children:"User"}),(0,b.jsx)(s.SelectItem,{value:"admin",children:"Admin"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(v.Label,{htmlFor:"userDepartment",children:"Department"}),(0,b.jsxs)(s.Select,{value:k.departmentId,onValueChange:a=>l({...k,departmentId:"none"===a?"":a}),children:[(0,b.jsx)(s.SelectTrigger,{children:(0,b.jsx)(s.SelectValue,{placeholder:"Select..."})}),(0,b.jsxs)(s.SelectContent,{children:[(0,b.jsx)(s.SelectItem,{value:"none",children:"None"}),f.map(a=>(0,b.jsx)(s.SelectItem,{value:String(a.id),children:a.name},a.id))]})]})]})]}),(0,b.jsxs)(u.DialogFooter,{children:[(0,b.jsx)(n.Button,{type:"button",variant:"outline",onClick:()=>d(!1),children:"Cancel"}),(0,b.jsx)(n.Button,{type:"submit",disabled:i,children:i?h?"Saving...":"Creating...":h?"Save Changes":"Create User"})]})]})]})})}var x=a.i(42710);function y(){let[a,h]=(0,c.useState)([]),[u,v]=(0,c.useState)([]),[y,z]=(0,c.useState)(!0),[A,B]=(0,c.useState)({page:1,total:0,totalPages:1}),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)("all"),[G,H]=(0,c.useState)(!1),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(null),O=(0,c.useCallback)(async(a=1)=>{try{let b=new URLSearchParams({page:String(a)});C&&b.set("search",C),"all"!==E&&b.set("role",E);let c=await fetch(`/api/users?${b}`),d=await c.json();if(!c.ok)throw Error(d.error);h(d.users||[]),B(d.pagination||{page:1,total:0,totalPages:1})}catch(a){m.toast.error(a?.message||"Failed to load users")}finally{z(!1)}},[C,E]);return((0,c.useEffect)(()=>{fetch("/api/departments").then(a=>a.json()).then(a=>v(a.departments||[])).catch(()=>{})},[]),(0,c.useEffect)(()=>{z(!0),O(1)},[O]),y&&0===a.length)?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,b.jsx)(q.Skeleton,{className:"h-7 w-40"}),(0,b.jsx)(q.Skeleton,{className:"h-9 w-32"})]}),(0,b.jsx)("div",{className:"rounded-lg border",children:(0,b.jsx)("div",{className:"space-y-2 p-4",children:Array.from({length:6}).map((a,c)=>(0,b.jsx)(q.Skeleton,{className:"h-8 w-full"},c))})})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("h2",{className:"text-2xl font-semibold font-[var(--font-display)]",children:"Manage Users"}),(0,b.jsx)(o.Badge,{variant:"secondary",children:A.total})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Create, edit, and manage user accounts"})]}),(0,b.jsxs)(n.Button,{onClick:()=>H(!0),children:[(0,b.jsx)(d.Plus,{className:"mr-2 h-4 w-4"}),"Add User"]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,b.jsx)("form",{onSubmit:function(a){a.preventDefault(),z(!0),O(1)},className:"flex items-center gap-2",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(j,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,b.jsx)(p.Input,{placeholder:"Search users...",value:C,onChange:a=>D(a.target.value),className:"w-64 pl-9"})]})}),(0,b.jsxs)(s.Select,{value:E,onValueChange:a=>F(a),children:[(0,b.jsx)(s.SelectTrigger,{className:"w-36",children:(0,b.jsx)(s.SelectValue,{placeholder:"All Roles"})}),(0,b.jsxs)(s.SelectContent,{children:[(0,b.jsx)(s.SelectItem,{value:"all",children:"All Roles"}),(0,b.jsx)(s.SelectItem,{value:"admin",children:"Admin"}),(0,b.jsx)(s.SelectItem,{value:"user",children:"User"})]})]})]}),0===a.length?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3 rounded-lg border py-12 text-center",children:[(0,b.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-muted",children:(0,b.jsx)(i,{className:"h-5 w-5 text-muted-foreground"})}),(0,b.jsx)("p",{className:"font-medium",children:"No users found"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:C||"all"!==E?"Try adjusting your search or filter.":"Create your first user to get started."})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"rounded-lg border",children:(0,b.jsxs)(r.Table,{children:[(0,b.jsx)(r.TableHeader,{children:(0,b.jsxs)(r.TableRow,{children:[(0,b.jsx)(r.TableHead,{children:"Username"}),(0,b.jsx)(r.TableHead,{children:"Full Name"}),(0,b.jsx)(r.TableHead,{children:"Email"}),(0,b.jsx)(r.TableHead,{children:"Role"}),(0,b.jsx)(r.TableHead,{children:"Department"}),(0,b.jsx)(r.TableHead,{children:"Last Login"}),(0,b.jsx)(r.TableHead,{className:"w-[70px]",children:"Actions"})]})}),(0,b.jsx)(r.TableBody,{children:a.map(a=>(0,b.jsxs)(r.TableRow,{children:[(0,b.jsx)(r.TableCell,{className:"font-medium",children:a.username||(0,b.jsx)("span",{className:"text-muted-foreground",children:"—"})}),(0,b.jsx)(r.TableCell,{children:a.full_name||"—"}),(0,b.jsx)(r.TableCell,{className:"text-muted-foreground",children:a.email}),(0,b.jsx)(r.TableCell,{children:(0,b.jsx)(o.Badge,{variant:"admin"===a.role?"default":"secondary",className:"capitalize",children:a.role})}),(0,b.jsx)(r.TableCell,{className:a.department_name?"":"text-muted-foreground",children:a.department_name||"—"}),(0,b.jsx)(r.TableCell,{className:"text-muted-foreground text-xs",children:a.last_login?new Date(a.last_login+"Z").toLocaleDateString():"Never"}),(0,b.jsx)(r.TableCell,{children:(0,b.jsxs)(t.DropdownMenu,{children:[(0,b.jsx)(t.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(n.Button,{variant:"ghost",className:"h-8 w-8 p-0",children:(0,b.jsx)(e.MoreHorizontal,{className:"h-4 w-4"})})}),(0,b.jsxs)(t.DropdownMenuContent,{align:"end",children:[(0,b.jsxs)(t.DropdownMenuItem,{onClick:()=>{N(a),J(!0)},children:[(0,b.jsx)(f.Pencil,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,b.jsxs)(t.DropdownMenuItem,{className:"text-destructive",onClick:()=>{N(a),L(!0)},children:[(0,b.jsx)(g.Trash2,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},a.id))})]})}),A.totalPages>1&&(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Page ",A.page," of ",A.totalPages," (",A.total," users)"]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(n.Button,{variant:"outline",size:"sm",disabled:A.page<=1,onClick:()=>O(A.page-1),children:[(0,b.jsx)(k.ChevronLeft,{className:"mr-1 h-4 w-4"}),"Previous"]}),(0,b.jsxs)(n.Button,{variant:"outline",size:"sm",disabled:A.page>=A.totalPages,onClick:()=>O(A.page+1),children:["Next",(0,b.jsx)(l.ChevronRight,{className:"ml-1 h-4 w-4"})]})]})]})]}),(0,b.jsx)(w,{open:G,onOpenChange:H,user:null,departments:u,onSuccess:function(a){m.toast.success(`User "${a.full_name||a.email}" created`),O(A.page)}}),(0,b.jsx)(w,{open:I,onOpenChange:J,user:M,departments:u,onSuccess:function(a){m.toast.success(`User "${a.full_name||a.email}" updated`),O(A.page)}}),(0,b.jsx)(x.DeleteDialog,{open:K,onOpenChange:L,title:"Delete User",description:`Are you sure you want to delete "${M?.full_name||M?.email}"? All their bookings will also be removed. This action cannot be undone.`,apiUrl:M?`/api/users/${M.id}`:null,onSuccess:function(){m.toast.success(`User "${M?.full_name||M?.email}" deleted`),O(A.page)}})]})}a.s(["default",()=>y],40950)}];

//# sourceMappingURL=src_app_dashboard_admin_users_page_jsx_d5ea13ff._.js.map