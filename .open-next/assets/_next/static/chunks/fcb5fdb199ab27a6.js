(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,73375,63059,e=>{"use strict";let s=(0,e.i(75254).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["ChevronLeft",()=>s],73375);var t=e.i(46349);e.s(["ChevronRight",()=>t.default],63059)},76794,e=>{"use strict";var s=e.i(43476);e.i(71645);var t=e.i(80064);function a({className:e,...a}){return(0,s.jsx)("textarea",{"data-slot":"textarea",className:(0,t.cn)("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...a})}e.s(["Textarea",()=>a])},89853,e=>{"use strict";let s=(0,e.i(75254).default)("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);e.s(["CalendarDays",()=>s],89853)},7637,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(7233),l=e.i(41071),r=e.i(88699),o=e.i(27612),n=e.i(63544),i=e.i(46696),c=e.i(56902),d=e.i(87167),u=e.i(43555),m=e.i(99411),h=e.i(95153),x=e.i(54613),p=e.i(53269),g=e.i(65930),j=e.i(76794),b=e.i(7095);function f({open:e,onOpenChange:a,classroom:l,onSuccess:r}){let o=!!l,[n,d]=(0,t.useState)(!1),[u,m]=(0,t.useState)([]),[h,f]=(0,t.useState)({name:"",groupId:"",location:"",capacity:"",description:"",notes:"",canBeBooked:!0,status:"available"});async function v(e){e.preventDefault(),d(!0);try{let e=o?`/api/classrooms/${l.id}`:"/api/classrooms",s=await fetch(e,{method:o?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:h.name,groupId:h.groupId?parseInt(h.groupId,10):null,location:h.location||null,capacity:h.capacity?parseInt(h.capacity,10):null,description:h.description||null,notes:h.notes||null,canBeBooked:h.canBeBooked,status:h.status})}),t=await s.json();if(!s.ok)throw Error(t.error||"Something went wrong");r?.(t.classroom,o?"updated":"created"),a(!1)}catch(e){i.toast.error(e?.message||"Failed to save classroom")}finally{d(!1)}}return(0,t.useEffect)(()=>{fetch("/api/room-groups").then(e=>e.json()).then(e=>m(e.roomGroups||[])).catch(()=>{})},[]),(0,t.useEffect)(()=>{l?f({name:l.name||"",groupId:l.group_id?String(l.group_id):"",location:l.location||"",capacity:l.capacity?.toString()||"",description:l.description||"",notes:l.notes||"",canBeBooked:0!==l.can_be_booked,status:l.status||"available"}):f({name:"",groupId:"",location:"",capacity:"",description:"",notes:"",canBeBooked:!0,status:"available"})},[l,e]),(0,s.jsx)(x.Dialog,{open:e,onOpenChange:a,children:(0,s.jsxs)(x.DialogContent,{className:"sm:max-w-[500px]",children:[(0,s.jsxs)(x.DialogHeader,{children:[(0,s.jsx)(x.DialogTitle,{children:o?"Edit Classroom":"Add Classroom"}),(0,s.jsx)(x.DialogDescription,{children:o?"Update the classroom details below.":"Fill in the details to create a new classroom."})]}),(0,s.jsxs)("form",{onSubmit:v,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(g.Label,{htmlFor:"name",children:"Name *"}),(0,s.jsx)(p.Input,{id:"name",value:h.name,onChange:e=>f({...h,name:e.target.value}),placeholder:"e.g. Lab Komputer 1",required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(g.Label,{htmlFor:"roomGroup",children:"Room Group"}),(0,s.jsxs)(b.Select,{value:h.groupId,onValueChange:e=>f({...h,groupId:"none"===e?"":e}),children:[(0,s.jsx)(b.SelectTrigger,{children:(0,s.jsx)(b.SelectValue,{placeholder:"Select group..."})}),(0,s.jsxs)(b.SelectContent,{children:[(0,s.jsx)(b.SelectItem,{value:"none",children:"None"}),u.map(e=>(0,s.jsx)(b.SelectItem,{value:String(e.id),children:e.name},e.id))]})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(g.Label,{htmlFor:"location",children:"Location"}),(0,s.jsx)(p.Input,{id:"location",value:h.location,onChange:e=>f({...h,location:e.target.value}),placeholder:"e.g. Block A, Level 2"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(g.Label,{htmlFor:"capacity",children:"Capacity"}),(0,s.jsx)(p.Input,{id:"capacity",type:"number",min:"0",value:h.capacity,onChange:e=>f({...h,capacity:e.target.value}),placeholder:"e.g. 40"})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(g.Label,{htmlFor:"description",children:"Description"}),(0,s.jsx)(j.Textarea,{id:"description",value:h.description,onChange:e=>f({...h,description:e.target.value}),placeholder:"Optional description...",rows:2})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(g.Label,{htmlFor:"notes",children:"Notes"}),(0,s.jsx)(j.Textarea,{id:"notes",value:h.notes,onChange:e=>f({...h,notes:e.target.value}),placeholder:"Internal notes...",rows:2})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(g.Label,{htmlFor:"status",children:"Status"}),(0,s.jsxs)(b.Select,{value:h.status,onValueChange:e=>f({...h,status:e}),children:[(0,s.jsx)(b.SelectTrigger,{children:(0,s.jsx)(b.SelectValue,{})}),(0,s.jsxs)(b.SelectContent,{children:[(0,s.jsx)(b.SelectItem,{value:"available",children:"Available"}),(0,s.jsx)(b.SelectItem,{value:"maintenance",children:"Maintenance"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(g.Label,{htmlFor:"bookable",children:"Bookable"}),(0,s.jsxs)(b.Select,{value:h.canBeBooked?"yes":"no",onValueChange:e=>f({...h,canBeBooked:"yes"===e}),children:[(0,s.jsx)(b.SelectTrigger,{children:(0,s.jsx)(b.SelectValue,{})}),(0,s.jsxs)(b.SelectContent,{children:[(0,s.jsx)(b.SelectItem,{value:"yes",children:"Yes"}),(0,s.jsx)(b.SelectItem,{value:"no",children:"No"})]})]})]})]}),(0,s.jsxs)(x.DialogFooter,{children:[(0,s.jsx)(c.Button,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,s.jsx)(c.Button,{type:"submit",disabled:n,children:n?o?"Saving...":"Creating...":o?"Save Changes":"Create Classroom"})]})]})]})})}function v({open:e,onOpenChange:a,classroom:l,onSuccess:r}){let[o,n]=(0,t.useState)(!1);async function d(){if(l){n(!0);try{let e=await fetch(`/api/classrooms/${l.id}`,{method:"DELETE"}),s=await e.json();if(!e.ok)throw Error(s.error||"Something went wrong");r?.(l),a(!1)}catch(e){i.toast.error(e?.message||"Failed to delete classroom")}finally{n(!1)}}}return(0,s.jsx)(x.Dialog,{open:e,onOpenChange:a,children:(0,s.jsxs)(x.DialogContent,{className:"sm:max-w-[425px]",children:[(0,s.jsxs)(x.DialogHeader,{children:[(0,s.jsx)(x.DialogTitle,{children:"Delete Classroom"}),(0,s.jsxs)(x.DialogDescription,{children:["Are you sure you want to delete"," ",(0,s.jsx)("span",{className:"font-semibold",children:l?.name}),"? This action cannot be undone."]})]}),(0,s.jsxs)(x.DialogFooter,{children:[(0,s.jsx)(c.Button,{variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,s.jsx)(c.Button,{variant:"destructive",onClick:d,disabled:o,children:o?"Deleting...":"Delete"})]})]})})}var y=e.i(18566),S=e.i(89853),N=e.i(73375),k=e.i(63059);let C=(0,e.i(75254).default)("circle-plus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);var w=e.i(20783),D=e.i(30030),I=e.i(81140),T=e.i(69340),B=e.i(99682),_=e.i(35804),E=e.i(96626),F=e.i(48425),P="Checkbox",[L,M]=(0,D.createContextScope)(P),[R,$]=L(P);function O(e){let{__scopeCheckbox:a,checked:l,children:r,defaultChecked:o,disabled:n,form:i,name:c,onCheckedChange:d,required:u,value:m="on",internal_do_not_use_render:h}=e,[x,p]=(0,T.useControllableState)({prop:l,defaultProp:o??!1,onChange:d,caller:P}),[g,j]=t.useState(null),[b,f]=t.useState(null),v=t.useRef(!1),y=!g||!!i||!!g.closest("form"),S={checked:x,disabled:n,setChecked:p,control:g,setControl:j,name:c,form:i,value:m,hasConsumerStoppedPropagationRef:v,required:u,defaultChecked:!U(o)&&o,isFormControl:y,bubbleInput:b,setBubbleInput:f};return(0,s.jsx)(R,{scope:a,...S,children:"function"==typeof h?h(S):r})}var H="CheckboxTrigger",V=t.forwardRef(({__scopeCheckbox:e,onKeyDown:a,onClick:l,...r},o)=>{let{control:n,value:i,disabled:c,checked:d,required:u,setControl:m,setChecked:h,hasConsumerStoppedPropagationRef:x,isFormControl:p,bubbleInput:g}=$(H,e),j=(0,w.useComposedRefs)(o,m),b=t.useRef(d);return t.useEffect(()=>{let e=n?.form;if(e){let s=()=>h(b.current);return e.addEventListener("reset",s),()=>e.removeEventListener("reset",s)}},[n,h]),(0,s.jsx)(F.Primitive.button,{type:"button",role:"checkbox","aria-checked":U(d)?"mixed":d,"aria-required":u,"data-state":J(d),"data-disabled":c?"":void 0,disabled:c,value:i,...r,ref:j,onKeyDown:(0,I.composeEventHandlers)(a,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:(0,I.composeEventHandlers)(l,e=>{h(e=>!!U(e)||!e),g&&p&&(x.current=e.isPropagationStopped(),x.current||e.stopPropagation())})})});V.displayName=H;var A=t.forwardRef((e,t)=>{let{__scopeCheckbox:a,name:l,checked:r,defaultChecked:o,required:n,disabled:i,value:c,onCheckedChange:d,form:u,...m}=e;return(0,s.jsx)(O,{__scopeCheckbox:a,checked:r,defaultChecked:o,disabled:i,required:n,onCheckedChange:d,name:l,form:u,value:c,internal_do_not_use_render:({isFormControl:e})=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(V,{...m,ref:t,__scopeCheckbox:a}),e&&(0,s.jsx)(K,{__scopeCheckbox:a})]})})});A.displayName=P;var q="CheckboxIndicator",G=t.forwardRef((e,t)=>{let{__scopeCheckbox:a,forceMount:l,...r}=e,o=$(q,a);return(0,s.jsx)(E.Presence,{present:l||U(o.checked)||!0===o.checked,children:(0,s.jsx)(F.Primitive.span,{"data-state":J(o.checked),"data-disabled":o.disabled?"":void 0,...r,ref:t,style:{pointerEvents:"none",...e.style}})})});G.displayName=q;var z="CheckboxBubbleInput",K=t.forwardRef(({__scopeCheckbox:e,...a},l)=>{let{control:r,hasConsumerStoppedPropagationRef:o,checked:n,defaultChecked:i,required:c,disabled:d,name:u,value:m,form:h,bubbleInput:x,setBubbleInput:p}=$(z,e),g=(0,w.useComposedRefs)(l,p),j=(0,B.usePrevious)(n),b=(0,_.useSize)(r);t.useEffect(()=>{if(!x)return;let e=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set,s=!o.current;if(j!==n&&e){let t=new Event("click",{bubbles:s});x.indeterminate=U(n),e.call(x,!U(n)&&n),x.dispatchEvent(t)}},[x,j,n,o]);let f=t.useRef(!U(n)&&n);return(0,s.jsx)(F.Primitive.input,{type:"checkbox","aria-hidden":!0,defaultChecked:i??f.current,required:c,disabled:d,name:u,value:m,form:h,...a,tabIndex:-1,ref:g,style:{...a.style,...b,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function U(e){return"indeterminate"===e}function J(e){return U(e)?"indeterminate":e?"checked":"unchecked"}K.displayName=z;var Y=e.i(78784),X=e.i(80064);let Q=t.forwardRef(({className:e,...t},a)=>(0,s.jsx)(A,{ref:a,"data-slot":"checkbox",className:(0,X.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary shadow focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:(0,s.jsx)(G,{"data-slot":"checkbox-indicator",className:(0,X.cn)("flex items-center justify-center text-current"),children:(0,s.jsx)(Y.CheckIcon,{className:"h-4 w-4"})})}));function W({open:e,onOpenChange:a,classroom:l,onSuccess:r,initialDate:o,initialTimeSlotId:n,lockDate:d=!1,lockTimeSlot:u=!1,multiSelect:m=!1,classrooms:h=[]}){let[f,v]=(0,t.useState)(!1),[y,S]=(0,t.useState)([]),[N,k]=(0,t.useState)([]),[C,w]=(0,t.useState)(""),[D,I]=(0,t.useState)({bookingDate:"",timeSlotId:"",purpose:"",teacherName:""});async function T(e){e.preventDefault();let s=m&&C?C:l?.id;if(!s)return void i.toast.error("Please select a classroom");let t=m?N:[D.timeSlotId];if(0===t.length)return void i.toast.error("Please select at least one time slot");v(!0);try{if(m){let e=await fetch("/api/bookings/bulk",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({classroomId:parseInt(s,10),bookingDate:D.bookingDate,timeSlotIds:t,purpose:D.purpose,teacherName:D.teacherName})}),l=await e.json();if(!e.ok)throw Error(l.error||"Failed to create bookings");r?.(l.bookings),a(!1),i.toast.success(`${l.bookings.length} booking(s) requested successfully`)}else{let e=await fetch("/api/bookings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({classroomId:parseInt(s,10),bookingDate:D.bookingDate,timeSlotId:D.timeSlotId,purpose:D.purpose,teacherName:D.teacherName})}),t=await e.json();if(!e.ok)throw Error(t.error||"Failed to create booking");r?.(t.booking),a(!1),i.toast.success("Booking requested successfully")}}catch(e){i.toast.error(e?.message||"Failed to create booking")}finally{v(!1)}}return(0,t.useEffect)(()=>{e&&(I({bookingDate:o||"",timeSlotId:n||"",purpose:"",teacherName:""}),m&&(k(n?[n]:[]),w(l?.id?String(l.id):"")),fetch("/api/time-slots").then(e=>e.json()).then(e=>S(e.timeSlots||[])).catch(()=>{i.toast.error("Failed to load time slots")}))},[e,o,n,m,l]),(0,s.jsx)(x.Dialog,{open:e,onOpenChange:a,children:(0,s.jsxs)(x.DialogContent,{className:"sm:max-w-[480px]",children:[(0,s.jsxs)(x.DialogHeader,{children:[(0,s.jsx)(x.DialogTitle,{children:"Book Classroom"}),(0,s.jsx)(x.DialogDescription,{children:m?"Select classrooms and time slots to book multiple at once.":l?.name?`Request a booking for ${l.name}.`:"Request a booking."})]}),(0,s.jsxs)("form",{onSubmit:T,className:"space-y-4",children:[m&&h.length>0&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(g.Label,{htmlFor:"classroom",children:"Classroom *"}),(0,s.jsxs)(b.Select,{value:C,onValueChange:w,children:[(0,s.jsx)(b.SelectTrigger,{id:"classroom",className:"w-full",children:(0,s.jsx)(b.SelectValue,{placeholder:"Select classroom"})}),(0,s.jsx)(b.SelectContent,{children:h.map(e=>(0,s.jsx)(b.SelectItem,{value:String(e.id),children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(g.Label,{htmlFor:"bookingDate",children:"Date *"}),(0,s.jsx)(p.Input,{id:"bookingDate",type:"date",value:D.bookingDate,onChange:e=>I(s=>({...s,bookingDate:e.target.value})),disabled:d,required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(g.Label,{htmlFor:"timeSlot",children:["Time Slot",m?"s":""," *"]}),m?(0,s.jsx)("div",{className:"max-h-60 space-y-2 overflow-y-auto rounded-md border p-3",children:0===y.length?(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No slots available"}):y.map(e=>(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(Q,{id:`slot-${e.id}`,checked:N.includes(String(e.id)),onCheckedChange:s=>{s?k(s=>[...s,String(e.id)]):k(s=>s.filter(s=>s!==String(e.id)))},disabled:u}),(0,s.jsxs)("label",{htmlFor:`slot-${e.id}`,className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:[e.label," (",e.start_time," - ",e.end_time,")"]})]},e.id))}):(0,s.jsxs)(b.Select,{value:D.timeSlotId,onValueChange:e=>I(s=>({...s,timeSlotId:e})),disabled:u,children:[(0,s.jsx)(b.SelectTrigger,{id:"timeSlot",className:"w-full",children:(0,s.jsx)(b.SelectValue,{placeholder:"Select time slot"})}),(0,s.jsxs)(b.SelectContent,{children:[0===y.length&&(0,s.jsx)(b.SelectItem,{value:"no-slots",disabled:!0,children:"No slots available"}),y.map(e=>(0,s.jsxs)(b.SelectItem,{value:String(e.id),children:[e.label," (",e.start_time," - ",e.end_time,")"]},e.id))]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(g.Label,{htmlFor:"teacherName",children:"Teacher Name"}),(0,s.jsx)(p.Input,{id:"teacherName",value:D.teacherName,onChange:e=>I(s=>({...s,teacherName:e.target.value})),placeholder:"Enter teacher name"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(g.Label,{htmlFor:"purpose",children:"Purpose"}),(0,s.jsx)(j.Textarea,{id:"purpose",value:D.purpose,onChange:e=>I(s=>({...s,purpose:e.target.value})),placeholder:"Describe the purpose of this booking",rows:3})]}),(0,s.jsxs)(x.DialogFooter,{children:[(0,s.jsx)(c.Button,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),(0,s.jsx)(c.Button,{type:"submit",disabled:f,children:f?"Submitting...":"Submit Request"})]})]})]})})}function Z(){return new Date().toISOString().slice(0,10)}Q.displayName="Checkbox";function ee(){let e=(0,y.useSearchParams)().get("date"),[a,l]=(0,t.useState)([]),[r,o]=(0,t.useState)([]),[n,u]=(0,t.useState)([]),[m,h]=(0,t.useState)([]),[x,g]=(0,t.useState)([]),[j,f]=(0,t.useState)(""),[v,w]=(0,t.useState)("all"),[D,I]=(0,t.useState)(e||Z()),[T,B]=(0,t.useState)(!1),[_,E]=(0,t.useState)(null),[F,P]=(0,t.useState)(""),[L,M]=(0,t.useState)(!1);(0,t.useEffect)(()=>{Promise.all([fetch("/api/sessions").then(e=>e.json()),fetch("/api/room-groups").then(e=>e.json()),fetch("/api/time-slots").then(e=>e.json())]).then(([e,s,t])=>{let a=e.sessions||[];if(l(a),o(s.roomGroups||[]),u(t.timeSlots||[]),a.length>0){var r,n;let e=Z(),s=a.find(s=>{var t,a;return t=s.start_date,a=s.end_date,e>=t&&e<=a})||a[0];f(String(s.id)),r=s.start_date,n=s.end_date,e>=r&&e<=n||I(s.start_date)}}).catch(()=>i.toast.error("Failed to load booking filters"))},[]),(0,t.useEffect)(()=>{if(!D)return;let e="all"===v?"":v,s=e?`/api/classrooms?groupId=${e}`:"/api/classrooms",t=e?`/api/bookings?date=${D}&groupId=${e}`:`/api/bookings?date=${D}`;Promise.all([fetch(s).then(e=>e.json()),fetch(t).then(e=>e.json())]).then(([e,s])=>{h(e.classrooms||[]),g(s.bookings||[])}).catch(()=>i.toast.error("Failed to load booking grid"))},[D,v]),(0,t.useEffect)(()=>{if(!j||0===a.length)return;let e=a.find(e=>String(e.id)===String(j));if(e){var s,t;s=e.start_date,t=e.end_date,D>=s&&D<=t||I(e.start_date)}},[j,a,D]);let R=(0,t.useMemo)(()=>{let e=new Map;return x.forEach(s=>{e.set(`${s.classroom_id}-${s.time_slot_id}`,s)}),e},[x]);return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"flex h-9 w-9 items-center justify-center rounded-full bg-muted",children:(0,s.jsx)(S.CalendarDays,{className:"h-4 w-4 text-foreground"})}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold text-foreground",children:"Booking Grid"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Choose a room and time slot to request a booking."})]})]}),(0,s.jsxs)(c.Button,{onClick:function(){0===m.length?i.toast.error("No classrooms available"):(E(m[0]),P(""),M(!0),B(!0))},variant:"outline",size:"sm",children:[(0,s.jsx)(C,{className:"mr-2 h-4 w-4"}),"Book Multiple Slots"]})]})}),(0,s.jsx)("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"rounded-lg border bg-background p-4",children:[(0,s.jsx)("label",{className:"text-xs font-medium text-muted-foreground",children:"Room Group"}),(0,s.jsxs)(b.Select,{value:v,onValueChange:w,children:[(0,s.jsx)(b.SelectTrigger,{className:"mt-3 w-full",children:(0,s.jsx)(b.SelectValue,{placeholder:"All Groups"})}),(0,s.jsxs)(b.SelectContent,{children:[(0,s.jsx)(b.SelectItem,{value:"all",children:"All Groups"}),r.map(e=>(0,s.jsx)(b.SelectItem,{value:String(e.id),children:e.name},e.id))]})]})]}),(0,s.jsxs)("div",{className:"rounded-lg border bg-background p-4",children:[(0,s.jsx)("label",{className:"text-xs font-medium text-muted-foreground",children:"Session"}),(0,s.jsxs)(b.Select,{value:j,onValueChange:f,children:[(0,s.jsx)(b.SelectTrigger,{className:"mt-3 w-full",children:(0,s.jsx)(b.SelectValue,{placeholder:"Select session"})}),(0,s.jsx)(b.SelectContent,{children:a.map(e=>(0,s.jsx)(b.SelectItem,{value:String(e.id),children:e.name},e.id))})]})]}),(0,s.jsxs)("div",{className:"rounded-lg border bg-background p-4",children:[(0,s.jsx)("label",{className:"text-xs font-medium text-muted-foreground",children:"Date"}),(0,s.jsx)(p.Input,{type:"date",value:D,onChange:e=>I(e.target.value),className:"mt-3 w-full"})]})]})}),(0,s.jsx)("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,s.jsxs)(c.Button,{variant:"outline",size:"sm",onClick:function(){let e=new Date(D);e.setDate(e.getDate()-1),I(e.toISOString().slice(0,10))},children:[(0,s.jsx)(N.ChevronLeft,{className:"mr-1 h-4 w-4"}),"Previous Day"]}),(0,s.jsx)(d.Badge,{variant:"secondary",className:"font-mono text-xs",children:D}),(0,s.jsxs)(c.Button,{variant:"outline",size:"sm",onClick:function(){let e=new Date(D);e.setDate(e.getDate()+1),I(e.toISOString().slice(0,10))},children:["Next Day",(0,s.jsx)(k.ChevronRight,{className:"ml-1 h-4 w-4"})]})]})}),(0,s.jsx)("div",{className:"rounded-xl border bg-card p-6 shadow-sm",children:(0,s.jsx)("div",{className:"overflow-x-auto rounded-xl border bg-background",children:(0,s.jsx)("div",{className:"min-w-[900px]",children:(0,s.jsxs)("table",{className:"w-full border-separate border-spacing-0",children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"border-b bg-muted/40 px-5 py-4 text-left text-sm font-semibold text-foreground",children:"Room"}),n.map((e,t)=>(0,s.jsxs)("th",{className:`border-b bg-muted/40 px-4 py-4 text-center text-sm font-semibold text-foreground ${t===n.length-1?"":"border-l"}`,children:[(0,s.jsx)("div",{children:e.label}),(0,s.jsxs)("div",{className:"mt-1 text-xs text-muted-foreground",children:[e.start_time," - ",e.end_time]})]},e.id))]})}),(0,s.jsx)("tbody",{children:m.map((e,t)=>(0,s.jsxs)("tr",{className:t%2?"bg-muted/20":"bg-background",children:[(0,s.jsx)("td",{className:"border-b px-5 py-4 text-sm font-semibold text-foreground",children:e.name}),n.map((t,a)=>{let l=R.get(`${e.id}-${t.id}`),r=!!l;return(0,s.jsx)("td",{className:`border-b px-4 py-4 text-center text-xs ${a===n.length-1?"":"border-l"}`,children:r?(0,s.jsxs)("div",{className:"rounded-md border border-rose-200 bg-rose-50 px-3 py-3 text-rose-700",children:[(0,s.jsx)("div",{className:"text-[0.7rem] font-semibold",children:"Booked"}),(0,s.jsx)("div",{className:"text-[0.65rem] text-rose-600",children:l.user_name||"Reserved"})]}):(0,s.jsx)("button",{type:"button",className:"w-full rounded-md border border-emerald-200 bg-emerald-50 px-3 py-3 text-[0.7rem] font-semibold text-emerald-700 transition hover:bg-emerald-100",onClick:()=>{E(e),P(String(t.id)),M(!1),B(!0)},children:"Available"})},t.id)})]},e.id))})]})})})}),(0,s.jsx)(W,{open:T,onOpenChange:B,classroom:_,classrooms:m,initialDate:D,initialTimeSlotId:F,lockDate:!L,lockTimeSlot:!L,multiSelect:L,onSuccess:function(){i.toast.success("Booking requested successfully"),B(!1);let e="all"===v?"":v;fetch(e?`/api/bookings?date=${D}&groupId=${e}`:`/api/bookings?date=${D}`).then(e=>e.json()).then(e=>{g(e.bookings||[])}).catch(()=>i.toast.error("Failed to refresh bookings"))}})]})}function es(){let[e,x]=(0,t.useState)([]),[p,g]=(0,t.useState)(!0),[j,b]=(0,t.useState)(null),[y,S]=(0,t.useState)(!1),[N,k]=(0,t.useState)(!1),[C,w]=(0,t.useState)(!1),[D,I]=(0,t.useState)(null),T=(0,t.useCallback)(async()=>{try{let e=await fetch("/api/classrooms"),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to load classrooms");x(s.classrooms||[])}catch(e){i.toast.error(e?.message||"Failed to load classrooms")}finally{g(!1)}},[]);(0,t.useEffect)(()=>{T(),fetch("/api/auth/me").then(e=>e.json()).then(e=>b(e.user)).catch(()=>{})},[T]);let B=j?.role==="admin";return p?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(u.Skeleton,{className:"h-7 w-40"}),(0,s.jsx)(u.Skeleton,{className:"h-4 w-64"})]}),(0,s.jsx)(u.Skeleton,{className:"h-9 w-32"})]}),(0,s.jsx)("div",{className:"rounded-lg border",children:(0,s.jsx)("div",{className:"space-y-2 p-4",children:Array.from({length:6}).map((e,t)=>(0,s.jsx)(u.Skeleton,{className:"h-8 w-full"},t))})})]}):B?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-4",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("h2",{className:"text-2xl font-semibold font-[var(--font-display)]",children:"Classrooms"}),(0,s.jsx)(d.Badge,{variant:"secondary",children:e.length})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage classroom details and availability"})]}),B&&(0,s.jsxs)(c.Button,{onClick:()=>S(!0),children:[(0,s.jsx)(a.Plus,{className:"mr-2 h-4 w-4"}),"Add Classroom"]})]}),0===e.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center gap-3 rounded-lg border py-12 text-center",children:[(0,s.jsx)("div",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-muted",children:(0,s.jsx)(n.School,{className:"h-5 w-5 text-muted-foreground"})}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"font-medium",children:"No classrooms yet"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Create your first classroom to get started."})]}),B&&(0,s.jsxs)(c.Button,{variant:"outline",className:"mt-4",onClick:()=>S(!0),children:[(0,s.jsx)(a.Plus,{className:"mr-2 h-4 w-4"}),"Add your first classroom"]})]}):(0,s.jsx)("div",{className:"rounded-lg border",children:(0,s.jsxs)(m.Table,{children:[(0,s.jsxs)(m.TableCaption,{children:["Showing ",e.length," classroom",1===e.length?"":"s"]}),(0,s.jsx)(m.TableHeader,{children:(0,s.jsxs)(m.TableRow,{children:[(0,s.jsx)(m.TableHead,{children:"Name"}),(0,s.jsx)(m.TableHead,{children:"Group"}),(0,s.jsx)(m.TableHead,{children:"Location"}),(0,s.jsx)(m.TableHead,{children:"Capacity"}),(0,s.jsx)(m.TableHead,{children:"Status"}),(0,s.jsx)(m.TableHead,{children:"Bookable"}),B&&(0,s.jsx)(m.TableHead,{className:"w-[70px]",children:"Actions"})]})}),(0,s.jsx)(m.TableBody,{children:e.map(e=>(0,s.jsxs)(m.TableRow,{children:[(0,s.jsx)(m.TableCell,{className:"font-medium",children:e.name}),(0,s.jsx)(m.TableCell,{className:e.group_name?"":"text-muted-foreground",children:e.group_name||"â€”"}),(0,s.jsx)(m.TableCell,{className:e.location?"":"text-muted-foreground",children:e.location||"â€”"}),(0,s.jsx)(m.TableCell,{className:null===e.capacity?"text-muted-foreground":"",children:e.capacity??"â€”"}),(0,s.jsx)(m.TableCell,{children:(0,s.jsx)(d.Badge,{variant:"available"===e.status?"default":"secondary",className:"capitalize",children:e.status})}),(0,s.jsx)(m.TableCell,{children:(0,s.jsx)(d.Badge,{variant:e.can_be_booked?"default":"secondary",children:e.can_be_booked?"Yes":"No"})}),B&&(0,s.jsx)(m.TableCell,{children:(0,s.jsxs)(h.DropdownMenu,{children:[(0,s.jsx)(h.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsx)(c.Button,{variant:"ghost",className:"h-8 w-8 p-0",children:(0,s.jsx)(l.MoreHorizontal,{className:"h-4 w-4"})})}),(0,s.jsxs)(h.DropdownMenuContent,{align:"end",children:[(0,s.jsxs)(h.DropdownMenuItem,{onClick:()=>{I(e),k(!0)},children:[(0,s.jsx)(r.Pencil,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,s.jsxs)(h.DropdownMenuItem,{className:"text-destructive",onClick:()=>{I(e),w(!0)},children:[(0,s.jsx)(o.Trash2,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},e.id))})]})}),(0,s.jsx)(f,{open:y,onOpenChange:S,classroom:null,onSuccess:function(e){x(s=>[...s,e].sort((e,s)=>e.name.localeCompare(s.name))),i.toast.success(`Classroom "${e.name}" created successfully`)}}),(0,s.jsx)(f,{open:N,onOpenChange:k,classroom:D,onSuccess:function(e){x(s=>s.map(s=>s.id===e.id?e:s).sort((e,s)=>e.name.localeCompare(s.name))),i.toast.success(`Classroom "${e.name}" updated successfully`)}}),(0,s.jsx)(v,{open:C,onOpenChange:w,classroom:D,onSuccess:function(e){x(s=>s.filter(s=>s.id!==e.id)),i.toast.success(`Classroom "${e.name}" deleted successfully`)}})]}):(0,s.jsx)(ee,{})}e.s(["default",()=>es],7637)}]);